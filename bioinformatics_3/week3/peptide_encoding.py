import typing
from itertools import product
from collections import defaultdict

from Bio.Seq import Seq
from genetic_code import aa_to_dna


def encoded_peptides(
    dna: str, peptide: str, genetic_code_reversed: typing.Dict["str", "str"]
) -> typing.List["str"]:
    """
    Find substrings of a genome encoding a given amino acid sequence.

    Args:
        seq: A DNA sequence
        peptide: An amino acid sequence using single letter notation

    Returns:
        All substrings of seq that produce the given amino acid.
    """
    frame = 3 * len(peptide)
    dna = Seq(dna)
    kmers = [dna[i: i + frame] for i in range(0, len(dna))]
    combos = defaultdict(list)
    for kmer in kmers:
        if len(kmer) % 3 == 0:
            combos[str(kmer.translate())].append(str(kmer))
            combos[str(kmer.reverse_complement().translate())
                   ].append(str(kmer))

    return combos.get(peptide)


dna = "TTCTATAGATCCAGGACTTTTCAAGTCACGTCTTGGGGTGTTGTAGATTTTGTTCAGCTAAGACTCCATCGGTGAGCTCGATGCCTGAATCTAGGTCGGTAACTACTAATTGCCTTTCTGCCATAGATGAGACAGTAGGGGTCATCTTCGCAGTTGCGATCTGCAGGAGGTAAGGGTAGCATTAACTGCCATCGACTGTCTTGTCCTAGGCGTAGTGGTATCATCGTACAAGTAGGCTGGCGAGCATCAGTATGCTATTGGATCCCCTACTCAGAACCGCTTAGTTCATCAGCAGTGCTATGTAATTGAGTCACCCCATCTCCTTGCATCCACGCCTGGGTCGCCACCGCAGGGCGGACAGGTTGGGTCAGGTGTACAGGTCCCAGTTACGTATCCAAGTCACATAGCACAGGTACGTTTTCGAAGGGCCTTACAGTTAAGGATCACTGACCCCAGCACAAGAATAGGGTTGCCAATCCTGTAGCAAAAGTTCCTCGAAACTGCTCTATCCGTGCTGTTTTGTTTCAATCCATGACTGATTTGTCGGCGTCGATAACCATGCGCAGGAGTCGCGTCTTCACACGCAATAAGAAGTTGCACTTGCAACATGGGACGCACAAGTAGGATTATTTATGCTTCAATAGGGTTGTTCCTCGGCAGGACTGAGCCAGAGTATGAGTGTCGCCGAACTCACGAAGCGGTCACGTAGAGCAATTGATCCAAGTGACTCCTTGGCTTAAAACTAAACGGCGAAAGCTTATGGAGGACTATCAAGTGTAGTAGATGGGCGCCTTAGCAAGCACGTCATATAAAGAGATTATGTGCAGTTGGGGACGGGGGGCCGACAATATTCCAGTTGTCTGTCCCACCATGCAGCTACTAAAAGTTCGGAGCCGTTAGTCTCCCTCTCTTCCCCATGAGCACATTATTTCTTTTGTAAGCTCCTACTCTACATATCAAAGAACCGGCAGACGCCACCACTATTGAAGATCGGTACGTATACAAAGGAAATTATGTGTAGCTGGGGAAGAGCGAACCTTTGGAGAGTCTAAAATCTATGAATAAACTTGGTCTCATAGATGCATTCGGACGATGTTTGGGATGGAAATCGGCAGTGGTAGATAGGTGGCCTATCCTCTGCAAGACCGTCCGAAAGGTAAGGCCAGTTTTTACCACAGAGTCGACGGATTCGATGACAGGCGTTGGCATAAGTGCTGTTTATGGGAGAACGTTGTGAGGTAGTTATACTACTGAAAAAGAGATTATGTGCTCGTGGGGAAGATGAAGTACTGACTAGCTGTAAGATTGAGGAAGTGATTCAGAAGCGCTGTTACTAAAGATAGGCTACGTCTTGCGAAGGCAGACTATGGAATGTTGACTTAGTTTCGTGATGATTAATCAAAAACCTTAAGAGTAGCCCAGAAAAGTCATACCTACCGCGGCGTTAGGACGTTGTAAGTCACGGCCGTGTGTCATTCCCCCGAGGGTAAGGCCATTGCGTTTCGATGTCATACAACCTGGACATAACGTGTCAAACAGCGACGTGGGAAAGACTGAAGGGGCATCAGGCCTCGCACAATAGTCTACGACAGTGCAGCTCACGGGGGCAATAATGCGACGATCGACGCTGGTTCCCACCTCGCATCAGCTTTGAATGTTACAAGCGAGGAAGCCCCTTGATGGTCTGTACAGCCTTCTTGGTCCTAAGCAGGCACTGGAATTGGGTTAGCGCAGAATCGCCGGGGGAGACTGGCTTGGTAACTTTGTTACTAGCGGACGTCCCCAACTACACATTATCTCTTTACCACTAGTGCCGTTGCACCTCCGAATAAAAACGAACGGTCAGCAAGTGCCCGCACTCATCGAGTATCGGTGAGTATCACTAAACAGGTGTCAAGTGGGAAGACTGAGGGTATATAAAGAATACCATAGTCACAAGGGCCTGTTGTGGGATTTACACATCAGTGTTTCGCACCGACGTAATCTTCCCCACGAACACATTATTTCTTTTGCACAGGCCTTCGTCGTTTGTTTGGGGTGCCGTCATTCCTATAAATTTACAACGGGCGTTACCAACCTTAATCCTCTTACCGCGCATCCCTTTTAACGCCTCATGAGTCTGAATGCCCAACAATTACTCATCCCGGGCACGAAGGAATCTTAATGATCTAGCCAGTGGTTAGCCTTATGGCCGGGATCGAGCCGCGCTTGAGATCGTCACCGCCAGTCAGTGATTACCCAATGCTTCAGTATATCGATTAACGGGAAAACTATCCCGGGCATTTATAGGGGGCTATGAGCTTATGGACTGACATAAGAAACGCCCCCAACTGCACATTATCTCCTTAGTGTCCCTCGACATGAGCTCAATGCGGTGCCTTAGGCGATGTGCGTCTCTGCGGATAACCGACAACAAATAGGGACACATGCAAAACGTATCAATTAGACGTCCAGGATGGTTTACACAAGCTTGCGCTACGAACGCCCGGGTTAAGGTAGGCCCTGTAACCGTTTGCCCGCAATGTAGAACGAGCGTCGCCGTACCAAGTCCATTGGAGCGCCTCAGAGTAATTAGAGTGCTCCTTAGTAGAGGCGGTGCTTTGGACATCTTCGATACCAATGCAAATCACCGAAAGCGAATCTCAGCACCATTATACTGCTGTGGACTAAGTCTTGGGTTCAGCCGGAGAATCTACTGATGGCCCCGCTTGCAGCTTCATCCGGCAGGAAGCTAGTGAATGGCGCTACCATCAACGATCGCCAAATGGGGGAATATCAGTCTCACCTGCCGCGGGACCTGCAAAAATGCCTAAATTCGGGCCCAGGGGCAGGGGAGGTTTGTCGATGAATAGGTATTTCGTTATTGTCGCTGGAATACGATTATGAACCGACTTCTTTAAACACGTAGTGCAAGTCTGTCCCACCTGAAACCTCCCATAATCTCCGCAAATCCGTGCACGCAATCTAATACGTGTTGACACTAGAGACGTATTAGAAAGAAATAATGTGCTCGTGGGGCCGTGCAGGGGCGCACAAAAGATAGATAAGTTCTTAAAACATGAAGCATTTCATTCTACTATAAGGCCACCAGACTCGTCCCCAGCTGCACATAATCTCCTTAAGCACCACCTTCGTCAAGAGACCCGAGGACTGAAAAATAAGAGGTGTCAGGTTGACTATACCCTGGCGTCGTCCATGCCTCAATGTCGAACGATAACAAGCAGTGCAACGTCAGCGTTGCCGAGGTATCGCAAACAAACTGGATGCTCGCTCATTAGAAGCTCAGGCTATCATATGCGGTAGGCAGAACCTCCGGGCCAGGGGTCTCGGCCAACACGGGTACGAGGGTGGTCGTACGGAATGCCGCCTCAATACATGTCTACACTGCAAAGGAAGAAGAGCCAAAGCCCTGTGTAGCACATAACGTTACCCCTACATGGCGGGCCGCCAGTAAGCGACCCCATCGGCCATCTTTCCTGTGCATCGGGGTCGCTAGCCTTCACTCGGGGGGTGCCCATCGAACGAAGTCCGGGGTAGTGCATCTATTTACATAGCACAACAGAGCAACCGCCCCCAGCTACACATTATCTCCTTGAGTTCCAATATTGTAGGAGCTAGGCACGATGTGTGATTTAGAATCAACCATCAGTGATTATAAGTCGAACCTTGACATAAACCGTAGCGAGACCTTGACCTGCGCCAACGAGAGCGCCAGAGAACAGGTACAGAAACTGGATAGACGCTGGTACAGACGCTGTACCACTGTGTACATGAGCATCTGAATCATGCATTTTCCCTTGTTATTCTGGGGAGACAAAAATCCCGGGATAACGTACAGGGGCTTCCTTTAACGCTATCTTAAAAGAAATAATGTGTTCTTGGGGAAGGGTCTATAAAAACTTGAATGGCATCATAGAAAACATGCCGTGGTAGGATTCACTACCATTGCGCACGAACTTTTTGAGTCTTGTTTCCCGCCGTGGCTGGAGACCGTAGGGACAGGGGCCGGGCTTGGTAGCGGGCGTCTCCTAAAAGTGCTAATGTACTAGCAGCCGTCTATGTGGTCCTCCCTTGGGGCTCGACGCGCGGCGCGAAACTGTAGGAGGGCCATACATCGTCTGGTCACATGCTGCTAGTAAGGAGATTATGTGTTCATGGGGTCGCAGCCTTCTGAATTTTAAGGGGGGCTGTTGCACGTCTATGTAATGGCTAATCAAGGGAAAGGAGATTATGTGTTCGTGGGGTCGAGTGGCAATTGACGACCTTGTATTGGGACCCTTTACGTCCTGTCCCGTGCCCTTGAATAGACTGTATTATGGACACATGACTTAACAATTGTGGTTAACGTGGCGCCATTGGTGTCCCTTTGTACGATCAAGACTTCTTGCGATTACTGGTTCGGCGAAGCCCTCTACTCTTTTACTGATGCCAAGGACACGGTATTGGACCCTCGGAGTGATGGCCAAAACATCTGAAACGGTTTGGCGCGTCTGGAATCGTCAGCAAGATGCGGTCAATTTCAACTTCGTTATGCCCATACGTGATTCGCCACCCCTGCATGCGAGCCTATAGGCTTAGGCTGGGCACATGGCAATGAGACAGAGAAGACATCTGTGCATTAATGGTGATGAATTATGTATAAGTGTATTCCGCTGAATCTAAACCCGTGCCCTTCCCCAACTGCACATGATTTCTTTATGTATTCGGCTAGGATAGGCTTTGGCGCCACTTCATGCCACAAGTCCGACATACTCAGAGCCACTGAGCTGCGGCTTTAGAGGAAGGTCTAGCCTCTTTCTGGCAATTTGCACGAGATCAGACCATCCTAAACCGTAACTTGACCTCCCCCTACTAAGCGCTTGAGCGGCGCCGAGCTGCCTATACGTAAGACCATAAGTCCATACATGCCACCTCGCTGAGACGCCAAATCTGGAAATCGTAGAGGCTCGTAATACCGCACTAATAAGCTGCCGAATGAGAGGTTCTCGGCGGATCACGCACCTGAACACACTGGCGCGCGGGAGGTATGCATCATTTCCAAATTTCCAAGTCGCCACTATAATATTGTTGCACCACGGACCAACGATACTCTGAGCCTGAATTCGGTACGAACGATGACCCCAGACCGCAGATTGAATGTTACCATGTTAGTGAAAATCTACCCCAGGAACACATAATTTCCTTTGTCCTAGGTTACGCTATGGACCTGCTACAATATCGGTGCCCAATGAGCGAGCATAACCTCCCCGTCCCGGTCGAAATCCCTGTCACCCCTAGTCCATGGGGCTCGCAAAGATAGCAGTCCGTCCAAAGCCATGTCAAAGAGATCATGTGTTCTTGGGGACGGCCCTCCCCAAGACTTGTCTCTACGCAATGAGCAGACCACGACTGTTAAAAGCAGCGCTCCCTTTGGGTTAAACCAGGCCAGACACATGAGGCCGCCATACCACATCTGCGTAGGGTGCTAACCTAGAGTTCAAAAGCATGCGAACTATAACCTTCTTCTTTTGTCCCCTGTCGGGTAGAAGACGGCGGCGAGCGGGTTCTACCTGCTTAACACAGATACGCTCTCATTACGCTCCAAGCGCAAAGATCCGTACCGTGTATATCGACAAACTCGTTCGGGGATCAACTGACGTCTTGTCTGAGGATCTAGAAACTCACGGCGTTAGCTACCACGGCCTCACATGGCAAACTTAATTAGGCTATTACAGTATAGCTCTCGGAATATGATTCCAAGGGGGTCCTACATTTTAGACCAACACATATACGCTGCGAAGGGACGCACGTTAGGTCCGAGGCCTCAGCCAGTCAGCGTCGGAGTTAGCTTATTCTACCCCACGAGCACATTATCTCCTTGTGTGCTGCACTTAGGGTTATCGCTAAGATACCCGCGCTGCTCAACCTGATTTAGGTCGGCCGTTACATCGTATGAGTCTTCATCTTCACGCGAATGACGAGCAGACCTCGAATTTCCTAGCCCTCCCGCCGGCCTGTGGTATGGCATATGCTCTCGGTGTACAGAGAAAGTATCGGGGCCGGGCAGCTCCGGTACAGGATTGAGGTGCAAAAACCCCGCTAGAGCTTAACAACGATAGCACGATTTCTCAGACTCTGTCAAGAGTTTACAATCTGAAGCCCCAGGACAGGCACTGAGTTCATGGGAGGGCATGAGTTCCCACCCACAAAGACCTCTGTTCACAATGGAATCTCTCTGCCCCAAATGAGATTAGGAGCTAGTCCTAAGTAGCGCGTTCTACGCATCCTTAACGAATCATTCAGACACTCGGGACTCGAACACTTTGTAAGTATAGTGTTCGTACTATGCTCGTAGGCCACCTGAATAACTCACTCGCATTTTATGGTTACGCCTCAGCTGGCTATTACTTGTGTACCAGACCCGAGCTCCCCACGAGCATCAATATTCAGTGCCTGCAATAGGAACCTTGCGGACAATGCCCAAGTTTGGCGGGCCATGCAAGGGGACCCCGGGTTTAACGTAACATCCTCCCCGCGGCGCTAGCAAGGGGTTAACAAAGATCGCCGACGCCACCATTCGCTATTGCATATAGACTACAGAGAAAGTCCCTCTGATATGAGGAGTGTGCACTTATTGTCTTCGCGCTTAGTCATGAGATTCTGTCTCCTATGAGTGAGCATCATCAGTGGCCCAAACAACAACAAACTATTTCCTTTGAGCAGTTGCACTCCGAATAACTGTACAATGTCAGATAGAGGAACGATCGCCAAGCAGACTGGCTCTTTCACTATGCGGCGGAGGTTGTCACATTCTGATCGTCGTTAGGACGGATCGGAGTTTATTGCTTGCACCTGGCGGACAGCGCTAGAGGTGAATCTTACCATTCTGAAGCCAATGCGATGCCTCACAACCCTGGGCTCTGTTCGCCACCACTCATAGGATTGGCACTCACTACGGATGCGTCCATACCTGTGAGAGAACCGTCTCCTGGTAAACTTGCGATCTGGATTTTGGAGGTAGCGCTATGGTTCTCCAGACACACAGGTTTTTCTCCTAAACAGCAGCACACGCTTCACGCGGATGCGGAAGGCCGCCCAACATACTCATACTTTGCACATGTCTTAACGCCACTGCCTACTTATCAAGAGGGTAAACGCCCCCGTCGATTTCCATCAAGCTATTGCTGAGGACATCATTGAGGAGGTGAATACCGAGGTGGTAAACACAAACACCGGCTCCCGCCTACCTTAAATTCTCCCTGGTGGTACTCGCGCTGCGCCGCTCTTCCATAACTCGTAAGAAGGAGATTATGTGTAGTTGGGGTCGGGTATTGGTTTTCTGGGGATTATGGCGGTGCTAAGTTCTGGTGAATAGCGGTCGTAACGCTTAATCGCCTAAATTCTTCCACCTCGAGGTACCCCACGGTCATTCCAGCATTCCCAGTCCCAGGGACTACCGCAGAGAATAAGTTTGCCGGCCACTGAACATGCACTACGTGTCCGCAGAGAAGTCGTCTGTGGTTCGTCCTTAACCGGGGTTCATGTAAGCAAATGGGTAAGCATTCGCTGCCAGGCGAGTGGTTTCCTCAACCAAATACCTCTCTAGTAGATCCCACTGTACCGAGGGGCTTCCACCGAATCTCAAATGTTAATCCGCTGCCTGCAAGCTTACTAGCTTCGTATCCGGCTAAACTCCTCCGTCTATAGACCGATAAGGGAAAGAGACTGACTGCAGATAATGGTGAACGCCAGTGACCCGACCGTTTGCCAATCTTGCATCGGAGCGGCCCCACGAACACATTATTTCCTTTGCACTGAGTCCGTCGGTTGATCTTTCCGTCTCTAAAGATTAGACAAAGGGCAACTGGCCATCGTTCTTGCTCCACCAACAAGTCTGCGTACATGTCTCCCAAGGAGAGTGTTTAATGAGCGTGAATAGTAATCATGGACACTGGCCTAATGCCGCGTTCGACTTAACATATCCGGAATGCCTTCCTGAACGATTACGCGTGGCATGGCTTAGCTTGGGGAGCGGCGAAGAGAGTAGCGTCTGGCACGTTCTAACTATTTTGGCAATTGAGCTTAGGGTTAGGGTCACCATTGAGAGGTTCACACCGCGCCCGCAAAAGTCCGCGAAGCCGAACCGCGGACATATATGGCGCGTACGGAACTTGCAAGGCTCTGTGAATAGCCCTGGGATAGAGGTTGGCTATAAACGATCTGCGAGGCGGCGCCAGTTGAACCTTTATTAACCCCAATTTCAAAGGGGAAAGAGGATCCCACGGTCTTGAGTGTAGTTCGGAATCTCAGTGTAGAGTTCGGCCTTGGGACCTGTTCGCGGCAAAGCTGGACGGACCAGAAGAGAGGGCGGGATGTCTGAATTCGTAGGTTTTATTAAGCCATTAAAATACATTTTACGGGCCTGCTGCGTCATGGCCCATTATCGCATTGGCCGTGGCGCGGTAGGTGGGAGTTGAGGCTCGCCCCTAGCGACTACATTGCATGCGAGTGTACGATCCGACTCCACGCTACAGATTAGAGGGACTACGTGAATAAATGGTTTTCCCCCTAGCAGAGCCCGGCCCCACGAACACATGATTTCCTTGCATACTTTGTGACCACTAGCGGATCCGACATTTTGAG"
peptide = "KEIMCSWGR"
print(*encoded_peptides(dna, peptide, aa_to_dna))
